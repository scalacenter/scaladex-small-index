<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-aws-kinesis-scala-" class="anchor" href="https://github.com/bizreach/aws-kinesis-scala#aws-kinesis-scala-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>aws-kinesis-scala <a href="https://travis-ci.org/bizreach/aws-kinesis-scala" target="_blank"><img src="https://camo.githubusercontent.com/ad9aa09b6a59fc6f0cde97955492450fbe0ae8ba/68747470733a2f2f7472617669732d63692e6f72672f62697a72656163682f6177732d6b696e657369732d7363616c612e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/bizreach/aws-kinesis-scala.svg?branch=master" style="max-width:100%;"></a></h1> 
  <p>Scala client for Amazon Kinesis with <a href="https://github.com/bizreach/aws-kinesis-scala#apache-spark" target="_blank">Apache Spark</a> support.</p> 
  <p>For Apache Spark, reading from Kinesis is supported by Spark Streaming Kinesis Integration, but it does not support writing to Kinesis. This library makes possible to write Spark's RDD and Spark Streaming's DStream to Kinesis.</p> 
  <h2><a id="user-content-installation" class="anchor" href="https://github.com/bizreach/aws-kinesis-scala#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <p>Add a following dependency into your <code>build.sbt</code>.</p> 
  <p>core only:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>jp.co.bizreach<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>aws-kinesis-scala<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.8<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>use spark integration:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>jp.co.bizreach<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>aws-kinesis-spark<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.8<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/bizreach/aws-kinesis-scala#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Create the <code>AmazonKinesis</code> at first.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">jp.co.bizreach.kinesis.</span><span class="pl-v">_</span>

<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">region</span> <span class="pl-k">=</span> <span class="pl-en">Regions</span>.<span class="pl-en">AP_NORTHEAST_1</span>

<span class="pl-c"><span class="pl-c">//</span> use DefaultAWSCredentialsProviderChain</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">AmazonKinesis</span>()

<span class="pl-c"><span class="pl-c">//</span> specify an explicit Provider</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">AmazonKinesis</span>(<span class="pl-k">new</span> <span class="pl-en">InstanceProfileCredentialsProvider</span>())

<span class="pl-c"><span class="pl-c">//</span> specify an explicit client configuration</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">AmazonKinesis</span>(<span class="pl-k">new</span> <span class="pl-en">ClientConfiguration</span>().withProxyHost(<span class="pl-s"><span class="pl-pds">"</span>proxyHost<span class="pl-pds">"</span></span>))

<span class="pl-c"><span class="pl-c">//</span> both</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">AmazonKinesis</span>(
  <span class="pl-k">new</span> <span class="pl-en">InstanceProfileCredentialsProvider</span>(),
  <span class="pl-k">new</span> <span class="pl-en">ClientConfiguration</span>().withProxyHost(<span class="pl-s"><span class="pl-pds">"</span>proxyHost<span class="pl-pds">"</span></span>)
)</pre>
  </div> 
  <p>Then you can access Kinesis as following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">request</span> <span class="pl-k">=</span> <span class="pl-en">PutRecordRequest</span>(
  streamName   <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>streamName<span class="pl-pds">"</span></span>,
  partitionKey <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>partitionKey<span class="pl-pds">"</span></span>,
  data         <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>.getBytes(<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>)
)

<span class="pl-c"><span class="pl-c">//</span> not retry</span>
client.putRecord(request)

<span class="pl-c"><span class="pl-c">//</span> if failure, max retry count is 3 (SDK default)</span>
client.putRecordWithRetry(request)</pre>
  </div> 
  <h3><a id="user-content-amazon-kinesis-firehose" class="anchor" href="https://github.com/bizreach/aws-kinesis-scala#amazon-kinesis-firehose" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Amazon Kinesis Firehose</h3> 
  <p>Create the <code>AmazonKinesisFirehose</code> at first.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">jp.co.bizreach.kinesisfirehose.</span><span class="pl-v">_</span>

<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">region</span> <span class="pl-k">=</span> <span class="pl-en">Regions</span>.<span class="pl-en">US_EAST_1</span>

<span class="pl-c"><span class="pl-c">//</span> use DefaultAWSCredentialsProviderChain</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">AmazonKinesisFirehose</span>()

... as <span class="pl-k">with</span> <span class="pl-e">kinesis</span> ...</pre>
  </div> 
  <p>Then you can access Kinesis Firehose as following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">request</span> <span class="pl-k">=</span> <span class="pl-en">PutRecordRequest</span>(
  deliveryStreamName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>firehose-example<span class="pl-pds">"</span></span>,
  record             <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>.getBytes(<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>)
)

<span class="pl-c"><span class="pl-c">//</span> not retry</span>
client.putRecord(request)

<span class="pl-c"><span class="pl-c">//</span> if failure, max retry count is 3 (SDK default)</span>
client.putRecordWithRetry(request)</pre>
  </div> 
  <h2><a id="user-content-apache-spark" class="anchor" href="https://github.com/bizreach/aws-kinesis-scala#apache-spark" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><a href="http://spark.apache.org" target="_blank">Apache Spark</a></h2> 
  <p>aws-kinesis-spark provides integration with Spark: for writing, methods that work on any <code>RDD</code>.</p> 
  <p>Import the <code>jp.co.bizreach.kinesis.spark._</code> to gain <code>saveToKinesis</code> method on your RDDs:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">jp.co.bizreach.kinesis.spark.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">rdd</span><span class="pl-k">:</span> <span class="pl-en">RDD</span>[<span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">Option</span>[<span class="pl-en">Any</span>]]] <span class="pl-k">=</span> ...

rdd.saveToKinesis(
  streamName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>streamName<span class="pl-pds">"</span></span>,
  region     <span class="pl-k">=</span> <span class="pl-en">Regions</span>.<span class="pl-en">AP_NORTHEAST_1</span>,
  chunk      <span class="pl-k">=</span> <span class="pl-c1">30</span>
)</pre>
  </div> 
  <p>You can also write data to Kinesis from Spark Streaming with DStreams.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">jp.co.bizreach.kinesis.spark.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">dstream</span><span class="pl-k">:</span> <span class="pl-en">DStream</span>[<span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">Option</span>[<span class="pl-en">Any</span>]]] <span class="pl-k">=</span> ...

dstream.foreachRDD { rdd <span class="pl-k">=&gt;</span>
  rdd.saveToKinesis( ... )
}</pre>
  </div> 
 </article>
</div>