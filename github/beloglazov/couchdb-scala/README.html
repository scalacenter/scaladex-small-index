<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-couchdb-scala" class="anchor" href="https://github.com/beloglazov/couchdb-scala#couchdb-scala" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>CouchDB-Scala</h1> 
  <p><a href="https://travis-ci.org/beloglazov/couchdb-scala" target="_blank"><img src="https://camo.githubusercontent.com/c9c3ca71bc9aae9e24aa178723559026d777d0b1/68747470733a2f2f7472617669732d63692e6f72672f62656c6f676c617a6f762f636f75636864622d7363616c612e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/beloglazov/couchdb-scala.svg?branch=master" style="max-width:100%;"></a> <a href="https://gitter.im/beloglazov/couchdb-scala?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/51fcfe28276900da28107f7815ec1068b8d034ac/68747470733a2f2f6261646765732e6769747465722e696d2f62656c6f676c617a6f762f636f75636864622d7363616c612e737667" alt="Join the chat at https://gitter.im/beloglazov/couchdb-scala" data-canonical-src="https://badges.gitter.im/beloglazov/couchdb-scala.svg" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.ibm/couchdb-scala_2.11" target="_blank"><img src="https://camo.githubusercontent.com/ffe5a86df25f30d4447680fe96febc2a89c084a7/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e69626d2f636f75636864622d7363616c615f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.ibm/couchdb-scala_2.11/badge.svg" style="max-width:100%;"></a> <a href="https://waffle.io/beloglazov/couchdb-scala" target="_blank"><img src="https://camo.githubusercontent.com/b6a3b47848d993986954aa10813c144d766616e0/68747470733a2f2f62616467652e776166666c652e696f2f62656c6f676c617a6f762f636f75636864622d7363616c612e706e673f6c6162656c3d7265616479267469746c653d5265616479" alt="Stories in Ready" data-canonical-src="https://badge.waffle.io/beloglazov/couchdb-scala.png?label=ready&amp;title=Ready" style="max-width:100%;"></a></p> 
  <p>This is a purely functional Scala client for <a href="http://couchdb.apache.org/" target="_blank">CouchDB</a>. The design goals are compositionality, expressiveness, type-safety, and ease of use.</p> 
  <p>It's based on these awesome libraries: <a href="https://github.com/scalaz/scalaz" target="_blank">Scalaz</a>, <a href="https://github.com/http4s/http4s" target="_blank">Http4s</a>, <a href="https://github.com/lihaoyi/upickle-pprint" target="_blank">uPickle</a>, and <a href="https://github.com/julien-truffaut/Monocle" target="_blank">Monocle</a>.</p> 
  <h2><a id="user-content-getting-started" class="anchor" href="https://github.com/beloglazov/couchdb-scala#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting started</h2> 
  <p>Add the following dependency to your SBT config:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.ibm<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>couchdb-scala<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.7.2<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-tutorial" class="anchor" href="https://github.com/beloglazov/couchdb-scala#tutorial" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tutorial</h2> 
  <p>This Scala client tries to stay as close to the native CouchDB API as possible, while adding type-safety and automatic serialization/deserialization of Scala objects to and from JSON using uPickle. The best way to get up to speed with the client is to first obtain a good understanding of how CouchDB works and its native API. Some good resources to learn CouchDB are:</p> 
  <ul> 
   <li><a href="http://guide.couchdb.org/" target="_blank">CouchDB: The Definitive Guide</a></li> 
   <li><a href="http://docs.couchdb.org/en/" target="_blank">CouchDB Documentation</a></li> 
  </ul> 
  <p>To get started, add the following import to your Scala file (or just start the SBT console with <code>sbt console</code>, which automatically adds the required imports):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ibm.couchdb.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>Then, you need to create a client instance by passing in the IP address or host name of the CouchDB server, port number, and optionally the scheme (which defaults to <code>http</code>):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">couch</span> <span class="pl-k">=</span> <span class="pl-en">CouchDb</span>(<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>, <span class="pl-c1">5984</span>)</pre>
  </div> 
  <p>Through this object, you get access to the following CouchDB API sections:</p> 
  <ul> 
   <li>Server: server-level operations</li> 
   <li>Databases: operations on databases</li> 
   <li>Design: operations for creating and managing design documents</li> 
   <li>Documents: creating, modifying, and querying documents and attachments</li> 
   <li>Query: querying views, shows, and lists</li> 
  </ul> 
  <h3><a id="user-content-server-api" class="anchor" href="https://github.com/beloglazov/couchdb-scala#server-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Server API</h3> 
  <p>The server API section provides only 3 operations: getting the server info, which is equivalent to making a GET request to the <code>/</code> resource of the CouchDB server; generating a UUID; and generating a sequence of UUIDs. For example, to make a server info request using the client instance created above:</p> 
  <div class="highlight highlight-source-scala">
   <pre>couch.server.info.run</pre>
  </div> 
  <p>The <code>couch.server</code> property refers to an instance of the <code>Server</code> class, which represents the server API section. Then, calling the <code>info</code> method generates a <a href="https://github.com/scalaz/scalaz/blob/scalaz-seven/concurrent/src/main/scala/scalaz/concurrent/Task.scala" target="_blank">scalaz.concurrent.Task</a>, which describes an action of making a GET request to the server. At this point, an actual request is not yet made. Instead, <code>Task</code> encapsulates a description of a computation, which can be executed later. This allows us to control side-effects and keep the functions pure. Tim Perrett has written a very nice <a href="http://timperrett.com/2014/07/20/scalaz-task-the-missing-documentation/" target="_blank">blog post</a> with more background and documentation on Scalaz's <code>Task</code>.</p> 
  <p>The return type of <code>couch.server.info</code> is <code>Task[Res.ServerInfo]</code>, which means that when this task is executed, it may return a <code>ServerInfo</code> object or fail. To execute a <code>Task</code>, we need to call the <code>run</code> method, which triggers the actual GET request to server, whose response is then automatically parsed and mapped onto the <code>ServerInfo</code> case class that contains a few fields describing the server instance like the CouchDB version, etc. Ideally, instead of executing a <code>Task</code> and causing side-effects in the middle of a program, we should delay the execution as much as possible to keep the core application logic pure. Rather then executing <code>Task</code>s to obtain the query result, we can perform action on the query results and compose <code>Task</code>s in a functional way using higher-order functions like <code>map</code> and <code>flatMap</code>, or for-comprehensions. We will see more examples of this later. In further code snippets, I will omit calls to the <code>run</code> method assuming that the point where effectful computations are executed is externalized.</p> 
  <p>The other operations of the server API can be performed in a similar way. To generate a UUID, you just need to call <code>couch.server.mkUuid</code>, which returns <code>Task[String]</code>. To generate <code>n</code> UUIDs, call <code>couch.server.mkUuids(n)</code>, which returns <code>Task[Seq[String]]</code> representing a task of generating a sequence of <code>n</code> UUIDs. For more usage examples, please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/ServerSpec.scala" target="_blank">ServerSpec</a>.</p> 
  <h3><a id="user-content-databases-api" class="anchor" href="https://github.com/beloglazov/couchdb-scala#databases-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Databases API</h3> 
  <p>The databases API implements more useful functionality like creating, deleting, and getting information about databases. To create a database:</p> 
  <div class="highlight highlight-source-scala">
   <pre>couch.dbs.create(<span class="pl-s"><span class="pl-pds">"</span>awesome-database<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>The <code>couch.dbs</code> property refers to an instance of the <code>Databases</code> class, which represents the databases API section. A call to the <code>create</code> method returns a <code>Task[Res.Ok]</code>, which represents a request returning an instance of the <code>Res.Ok</code> case class if it succeeds, or a failure object if it fails. Failure handling is done using methods on <code>Task</code>, part of which are covered in Tim Perrett's <a href="http://timperrett.com/2014/07/20/scalaz-task-the-missing-documentation/" target="_blank">blog post</a>. In two words the actual result of a <code>Task</code> execution is <code>Throwable \/ A</code>, which is <a href="https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/Either.scala" target="_blank">either</a> an exception or the desired type <code>A</code>. In the case or <code>dbs.create</code>, the desired result is of type <code>Res.Ok</code>, which is a case class representing a response from the server in case of a succeeded request.</p> 
  <p>Other methods provided by the databases API are <code>dbs.delete("awesome-database")</code> to delete a database, <code>dbs.get("awesome-database")</code> to get information about a database returned as an instance of <code>DbInfo</code> case class that includes such fields as data size, number of documents in the database, etc. For some examples of using the databases API, please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/DatabasesSpec.scala" target="_blank">DatabasesSpec</a>.</p> 
  <h3><a id="user-content-design-api" class="anchor" href="https://github.com/beloglazov/couchdb-scala#design-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Design API</h3> 
  <p>While the API sections described earlier operate at the level above databases, the Design, Documents, and Query APIs are applied within the context of a single database. Therefore, to obtain instances of these interfaces, the context needs to be specialized by specifying the name of a database of interest:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">db</span> <span class="pl-k">=</span> couch.db(<span class="pl-s"><span class="pl-pds">"</span>awesome-database<span class="pl-pds">"</span></span>, <span class="pl-en">TypeMapping</span>.empty)</pre>
  </div> 
  <p>This method call returns an instance of the <code>CouchDbApi</code> case class representing the context of a single database, through which we can get access to the Design, Documents, and Query APIs. The <code>db</code> method takes 2 arguments: the database name and an instance of <code>TypeMapping</code>. We will discuss <code>TypeMapping</code> later, for now we can just pass an empty mapping using <code>TypeMapping.empty</code>. Through <code>CouchDbApi</code> we can obtain an instance of the <code>Design</code> class representing the Design API section for our database:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.design</pre>
  </div> 
  <p>The Design API allows us to create, retrieve, update, delete, and manage attachments to design documents stored in the current database (you can get the name of the database from an instance of <code>CouchDbApi</code> using <code>db.name</code>).</p> 
  <p>Let's take a look at an example of a design document with a single view. First, assume we have a collection of people each corresponding to an object of a case class <code>Person</code> with a name and age fields:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Person</span>(<span class="pl-v">name</span>: <span class="pl-k">String</span>, <span class="pl-v">age</span>: <span class="pl-k">Int</span>)</pre>
  </div> 
  <p>Let's define a view with just a map function that emits person names as keys and ages as values. To do that, we are going to use a <code>CouchView</code> case class:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">ageView</span> <span class="pl-k">=</span> <span class="pl-en">CouchView</span>(map <span class="pl-k">=</span>
    <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">    |function(doc) {</span>
<span class="pl-s">    |   emit(doc.doc.name, doc.doc.age);</span>
<span class="pl-s">    |}</span>
<span class="pl-s">    <span class="pl-pds">"""</span></span>.stripMargin)</pre>
  </div> 
  <p>Basically, we define our map function in plain JavaScript and assign it to the <code>map</code> field of a <code>CouchView</code> object. This function maps each document to a pair of the person's name as the key and age as the value. Notice, that we need to use <code>doc.doc</code> to get to the fields of the person object for reasons that will become clear later. To define a view that contains a reduce operation, specify the relevant Javascript function to the <code>reduce</code> attribute of the <code>CouchView</code> case class constructor like so:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">totalAgeView</span> <span class="pl-k">=</span> <span class="pl-en">CouchView</span>(map <span class="pl-k">=</span>
    <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">    |function(doc) {</span>
<span class="pl-s">    |   emit(doc._id, doc.doc.age);</span>
<span class="pl-s">    |}</span>
<span class="pl-s">    <span class="pl-pds">"""</span></span>.stripMargin,
    reduce <span class="pl-k">=</span>
    <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">    |function(key, values, rereduce) {</span>
<span class="pl-s">    |   return sum(values);</span>
<span class="pl-s">    |}</span>
<span class="pl-s">    <span class="pl-pds">"""</span></span>.stripMargin)</pre>
  </div> 
  <p>We can now create an instance of our design document using the defined <code>ageView</code> and <code>totalAgeView</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">designDoc</span> <span class="pl-k">=</span> <span class="pl-en">CouchDesign</span>(
    name  <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>test-design<span class="pl-pds">"</span></span>,
    views <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>age-view<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> ageView, <span class="pl-s"><span class="pl-pds">"</span>total-age-view<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> totalAgeView))</pre>
  </div> 
  <p><code>CouchDesign</code> supports other fields like <code>shows</code> and <code>lists</code>, but for this simple example we only specify the design <code>name</code> and <code>views</code> as a <code>Map</code> from view names to <code>CouchView</code> objects. Proper management of complex design documents is a separate topic (e.g., JavaScript functions can be stored in separate <code>.js</code> files and loaded dynamically). We can finally proceed to submitting the defined design document to our database:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.design.create(designDoc)</pre>
  </div> 
  <p>This method call returns an object of type <code>Task[Res.DocOk]</code>. The <code>DocOk</code> case class represents a response from the server to a succeeded request involving creating, modifying, and deleting documents. Compared with <code>Res.Ok</code>, it includes 2 extra fields: <code>id</code> (the ID of the created/updated/deleted document) and <code>rev</code> (the revision of the created/updated/deleted document). In the case of design documents, the ID is composed of the design name prefixed with <code>_design/</code>. In other words, <code>designDoc</code> will get the <code>_design/test-design</code> ID. Each revision is a unique 32-character UUID string. We can now retrieve the design document from the database by name or by ID:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.design.get(<span class="pl-s"><span class="pl-pds">"</span>test-design<span class="pl-pds">"</span></span>)
db.design.getById(<span class="pl-s"><span class="pl-pds">"</span>_design/test-design<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Once the returned <code>Task</code>s are executed, each of these calls returns an instance of <code>CouchDesign</code> corresponding to our design document with some extra fields, e.g., <code>_id</code>, <code>_rev</code>, <code>_attachments</code>, etc. To update a design document, we must first retrieve it from the database to know the current revision and avoid <a href="http://guide.couchdb.org/draft/conflicts.html" target="_blank">conflicts</a>, make changes to the content, and submit the updated version. Let's say we want to add another view, which emits ages as keys and names as values assigned to a <code>nameView</code> variable, then our updated view <code>Map</code> is:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">updatedViews</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(
    <span class="pl-s"><span class="pl-pds">"</span>age-view<span class="pl-pds">"</span></span>  <span class="pl-k">-</span><span class="pl-k">&gt;</span> ageView,
    <span class="pl-s"><span class="pl-pds">"</span>name-view<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> nameView)</pre>
  </div> 
  <p>We can now submit the changes to the database as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">for</span> {
    initial <span class="pl-k">&lt;</span><span class="pl-k">-</span> db.design.get(<span class="pl-s"><span class="pl-pds">"</span>test-design<span class="pl-pds">"</span></span>)
    docOk   <span class="pl-k">&lt;</span><span class="pl-k">-</span> db.design.update(initial.copy(views <span class="pl-k">=</span> updatedViews))
} <span class="pl-k">yield</span> docOk</pre>
  </div> 
  <p>Here, we use a for-comprehension to chain 2 monadic actions. If both actions succeed, we get a <code>Res.DocOk</code> object as a result containing the new revision of the design document stored in the <code>_rev</code> field. The Design API supports a few other operations, to see their usage examples please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/DesignSpec.scala" target="_blank">DesignSpec</a>.</p> 
  <h3><a id="user-content-documents-api" class="anchor" href="https://github.com/beloglazov/couchdb-scala#documents-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Documents API</h3> 
  <p>The Documents API implements operations for creating, querying, modifying, and deleting documents and their attachments. At this stage, it's time to discuss how Scala objects are represented in CouchDB and what <code>TypeMapping</code> is used for. One of the design goals of <code>CouchDB-Scala</code> is to make it as easy as possible to store and retrieve documents by automating the process of serialization and deserialization to and from JSON. This functionality is based on <a href="https://github.com/lihaoyi/upickle-pprint" target="_blank">uPickle</a>, which uses macros to automatically generate readers and writers for case classes. However, it also allows implementing custom readers and writers for your domain classes if they are not <em>case classes</em>. For example, these can be <a href="https://thrift.apache.org/" target="_blank">Thrift</a> / <a href="https://github.com/twitter/scrooge" target="_blank">Scrooge</a> generated entities or your custom classes.</p> 
  <p>CouchDB automatically adds several fields to every document containing metadata about the document, such as <code>_id</code>, <code>_rev</code>, <code>_attachments</code>, <code>_conflicts</code>, etc. To take advantage of uPickle's support for case classes, a decision was made to have a case class called <code>CouchDoc[D]</code> that has all the metadata fields generated by CouchDB and also includes 2 special fields: <code>doc</code> for storing an instance of your domain class <code>D</code>, and <code>kind</code> for storing a string representation of the document type that can be used for filtering in views, shows, and lists (we use <code>kind</code> instead of <code>type</code> here, as <code>type</code> is a reserved keyword in Scala). In other words, if your domain model is represented by a set of case classes, the serialization and deserialization will be handled completely transparently for you. <code>TypeMapping</code> is used for defining a mapping from you domain model classes to a string representation of the corresponding document type. Continuing the previous example with the <code>Person</code> case class, we can define a <code>TypeMapping</code>, for example, as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">typeMapping</span> <span class="pl-k">=</span> <span class="pl-en">TypeMapping</span>(<span class="pl-c1">classOf</span>[<span class="pl-en">Person</span>] <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Person<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Here, we are specifying a mapping from the class name <code>Person</code> to a document kind as a string. The <code>TypeMapping</code> factory maps classes to their canonical names to preserve uniqueness. Whenever a document is submitted to the database, the <code>kind</code> field is automatically populated based on the specified mapping. If the type mapping is not specified (as we did above by using <code>TypeMapping.empty</code>), the <code>kind</code> field is ignored. We can now provide the newly defined <code>TypeMapping</code> to create a fully specified database context:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">db</span> <span class="pl-k">=</span> couch.db(<span class="pl-s"><span class="pl-pds">"</span>awesome-database<span class="pl-pds">"</span></span>, typeMapping)</pre>
  </div> 
  <p>Similarly to the other API sections, we can use the database context to get an instance of the <code>Documents</code> class representing the Documents API section:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs</pre>
  </div> 
  <p>Let's define some data:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">alice</span> <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Alice<span class="pl-pds">"</span></span>, <span class="pl-c1">25</span>)
<span class="pl-k">val</span> <span class="pl-en">bob</span>   <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Bob<span class="pl-pds">"</span></span>, <span class="pl-c1">30</span>)
<span class="pl-k">val</span> <span class="pl-en">carl</span>  <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Carl<span class="pl-pds">"</span></span>, <span class="pl-c1">20</span>)</pre>
  </div> 
  <p>We can now store these objects in the database as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.create(alice)</pre>
  </div> 
  <p>This method assigns a UUID generated with <code>server.mkUuid</code> that we've seen above to the document being stored. Another option is to specify our own document ID if it's known to be unique:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.create(bob, <span class="pl-s"><span class="pl-pds">"</span>bob<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>As another alternative, we can create multiple documents with auto-generated UUIDs at once using a batch request:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.createMany(<span class="pl-en">Seq</span>(alice, bob, carl))</pre>
  </div> 
  <p>We can retrieve a document from the database by ID:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.get[<span class="pl-en">Person</span>](<span class="pl-s"><span class="pl-pds">"</span>bob<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Here, we have to be explicit about the expected object type to allow uPickle to do its magic, that's why we specify the type parameter to the <code>get</code> method. This method returns <code>Task[CouchDoc[Person]]</code>, which basically means that we are getting back a task that after executing successfully will give us an instance of <code>CouchDoc[Person]</code>. This object will contain an instance of <code>Person</code> in the <code>doc</code> field equivalent to the original <code>Person("Bob", 30)</code>.</p> 
  <p>You can also retrieve a set of documents by IDs using:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.getMany.includeDocs[<span class="pl-en">Person</span>].withIds(<span class="pl-en">Seq</span>(<span class="pl-s"><span class="pl-pds">"</span>id1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>id1<span class="pl-pds">"</span></span>)).build.query</pre>
  </div> 
  <p>A call to <code>getMany</code> returns an instance of <code>GetManyDocumentsQueryBuilder</code>, which is a class allowing you to build a query in a type-safe way. Under the hood, it makes a request to the <a href="http://docs.couchdb.org/en/1.6.1/api/database/bulk-api.html#get--db-_all_docs" target="_blank">/{db}/_all_docs</a> endpoint. As you can see from the linked documentation on this endpoint, it has many optional parameters. The <code>GetManyDocumentsQueryBuilder</code> class provides a fluent interface for constructing queries to this endpoint. For example, to limit the number of documents to the maximum of 10 and return them in the descending order:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.docs.getMany.limit(<span class="pl-c1">10</span>).descending.includeDocs[<span class="pl-en">Person</span>].withIds(<span class="pl-en">Seq</span>(<span class="pl-s"><span class="pl-pds">"</span>id1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>id2<span class="pl-pds">"</span></span>)).build.query</pre>
  </div> 
  <p>This creates an instance of <code>Task[CouchDocs[String, CouchDocRev, Person]]</code>, which looks complicated but just represents a task that returns basically a sequence of documents. The <code>queryIncludeDocs</code> method serves as a way to complete the query construction process, which also sets the <code>include_docs</code> option to include the full content of the documents mapped to <code>Person</code> objects on arrival.</p> 
  <p>It's also possible to execute a query without including the document content using <code>db.docs.getMany.build.query</code>, which is equivalent to keeping the <code>include_docs</code> set to its default <code>false</code> value. This query will only return metadata on the matching documents. In this case, we don't need to specify the type parameter as no mapping is required since the document content is not retrieved.</p> 
  <p>To retrieve all documents in the database of a given type without specifying ids, you could use one of the following approaches:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">allPeople1</span> <span class="pl-k">=</span> db.docs.getMany.byTypeUsingTemporaryView[<span class="pl-en">Person</span>].build.query</pre>
  </div> 
  <p>The first approach, <code>byTypeUsingTemporaryView[T]</code>, uses a temporary view under the hood for type based filtering. While convenient for development purposes, it is inefficient and should not be used in production.</p> 
  <p>For efficiency you should instead use <code>byType[K, V](view_name)</code>, or the simpler <code>byType[V](view_name)</code>, which require that you first create a type filtering permanent view, and then pass its name as argument to one of these methods. Because a permanent view is used, these approaches are more efficient and are thus the recommended approach for type based document filtering.</p> 
  <p>Note in <code>byType[K, V](view_name)</code> the parameters <code>K</code> and <code>V</code> represent the key and value types of the permanent view. The document's <code>kind</code> attribute must be the first key of such a view, as in the type filter view function example shown below.</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">function</span>(<span class="pl-smi">doc</span>) {
    <span class="pl-en">emit</span>([<span class="pl-smi">doc</span>.<span class="pl-smi">kind</span>, <span class="pl-smi">doc</span>.<span class="pl-smi">_id</span>], <span class="pl-smi">doc</span>.<span class="pl-smi">_id</span>);
}</pre>
  </div> 
  <p>The above function could then be used as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">allPeople2</span> <span class="pl-k">=</span> db.docs.getMany.byType[(<span class="pl-k">String</span>, <span class="pl-k">String</span>), <span class="pl-k">String</span>](your_view_name).build.query</pre>
  </div> 
  <p>In the simpler <code>byType[V](view_name)</code>, <code>K</code> is implicitly assumed to be of type Tuple of two strings <code>(String, String)</code>. Note the document's <code>kind</code> attribute must be the first key of such a view, as in the type filter view function example defined above.</p> 
  <p>The above function could then be used as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">allPeople3</span> <span class="pl-k">=</span> db.docs.getMany.byType[<span class="pl-k">String</span>](your_view_name).build.query</pre>
  </div> 
  <p>There is a similar query builder for retrieving single documents <code>GetDocumentQueryBuilder</code> that makes GET requests to the <a href="http://docs.couchdb.org/en/1.6.1/api/document/common.html#get--db-docid" target="_blank">/{db}/{docid}</a> endpoint. This query builder can accessed through <code>db.docs.get</code>.</p> 
  <p>There are other operations provided by the Documents API, such as updating documents, deleting documents, adding attachments, retrieving attachments, etc. For more usage examples, please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/DocumentsSpec.scala" target="_blank">DocumentsSpec</a>.</p> 
  <h3><a id="user-content-query-api" class="anchor" href="https://github.com/beloglazov/couchdb-scala#query-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Query API</h3> 
  <p>The Query API provides an interface for querying views, shows, and lists. Let's say we want to query our <code>age-view</code> defined earlier. To do that, we first obtain an instance of <code>ViewQueryBuilder</code> as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">ageView</span> <span class="pl-k">=</span> db.query.view[<span class="pl-k">String</span>, <span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>test-design<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>age-view<span class="pl-pds">"</span></span>).get
<span class="pl-k">val</span> <span class="pl-en">totalAgeView</span> <span class="pl-k">=</span> db.query.view[<span class="pl-k">String</span>, <span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>test-design<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>total-age-view<span class="pl-pds">"</span></span>).get</pre>
  </div> 
  <p>We need to specify 2 type parameters to the <code>view</code> method representing the types of the key and value emitted by the view. In the case of <code>age-view</code> and <code>total-age-view</code>, it's <code>String</code> for the key (person name) and <code>Int</code> for the value (person age).</p> 
  <p>We can now use the <code>ageView</code> query builder to retrieve all the documents from the view:</p> 
  <div class="highlight highlight-source-scala">
   <pre>ageView.build.query</pre>
  </div> 
  <p>This method call returns an instance of <code>Task[CouchKeyVals[String, Int]]</code>. Since we haven't specified the <code>include_docs</code> option, this query only retrieves a sequence of document IDs, keys, and values emitted by the view's map function. This method makes a call to the <a href="http://docs.couchdb.org/en/1.6.1/api/ddoc/views.html#get--db-_design-ddoc-_view-view" target="_blank">/{db}/_design/{ddoc}/_view/{view}</a> endpoint, and the builder supports all the relevant options.</p> 
  <p>Similarly, to query the total age of Persons in the document using the <code>totalAgeView</code> builder we can do:</p> 
  <div class="highlight highlight-source-scala">
   <pre>totalAgeView.reduce[<span class="pl-k">Int</span>].build.query</pre>
  </div> 
  <p>The type parameter <code>T</code> specified to <code>queryWithReduce[T]</code>, in this case <code>Int</code>, is the expected return type of the view's <code>reduce</code> function.</p> 
  <p>We can also make more complex queries. Let's say we want to get 10 people starting from the name Bob and include the document content:</p> 
  <div class="highlight highlight-source-scala">
   <pre>ageView.startKey(<span class="pl-s"><span class="pl-pds">"</span>Bob<span class="pl-pds">"</span></span>).limit(<span class="pl-c1">10</span>).includeDocs[<span class="pl-en">Person</span>].build.query</pre>
  </div> 
  <p>This returns an instance of <code>Task[CouchDocs[String, Int, Person]]</code>, which once executed results in a sequence of objects encapsulating the metadata about the documents (<code>id</code>, <code>key</code>, <code>value</code>, <code>offset</code>, <code>total_rows</code>) and the corresponding <code>Person</code> objects. Please follow the definitions of case classes in <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/main/scala/com/ibm/couchdb/model/CouchModel.scala" target="_blank">CouchModel</a> to fully understand the structure of the returned objects.</p> 
  <p>It's also possible to only get the documents from a view that match the specified keys. For example, we can use that to get only documents of Alice and Carl:</p> 
  <div class="highlight highlight-source-scala">
   <pre>ageView.withIds(<span class="pl-en">Seq</span>(<span class="pl-s"><span class="pl-pds">"</span>Alice<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Carl<span class="pl-pds">"</span></span>)).build.query</pre>
  </div> 
  <p>This return an instance of <code>Task[CouchKeyVals[String, Int]]</code>. For other usage examples of the view Query API, please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/QueryViewSpec.scala" target="_blank">QueryViewSpec</a>.</p> 
  <p>The APIs for querying shows and lists are structured similarly to view querying and follow the official CouchDB specification. Please refer to <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/QueryShowSpec.scala" target="_blank">QueryShowSpec</a> and <a href="https://github.com/beloglazov/couchdb-scala/blob/master/src/test/scala/com/ibm/couchdb/api/QueryListSpec.scala" target="_blank">QueryListSpec</a> for more details and examples.</p> 
  <h3><a id="user-content-authentication" class="anchor" href="https://github.com/beloglazov/couchdb-scala#authentication" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Authentication</h3> 
  <p>At the moment, the client supports only the <a href="http://docs.couchdb.org/en/1.6.1/api/server/authn.html#basic-authentication" target="_blank">basic authentication</a> method. To use it, just pass your username and password to the <code>CouchDb</code> factory:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">couch</span> <span class="pl-k">=</span> <span class="pl-en">CouchDb</span>(<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>, <span class="pl-c1">6984</span>, https <span class="pl-k">=</span> <span class="pl-c1">true</span>, <span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Please note that <a href="http://docs.couchdb.org/en/1.6.1/config/http.html#config-ssl" target="_blank">enabling HTTPS</a> is recommended to avoid sending your credentials in plain text. The default CouchDB HTTPS port is 6984.</p> 
  <h3><a id="user-content-complete-example" class="anchor" href="https://github.com/beloglazov/couchdb-scala#complete-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Complete example</h3> 
  <p>Here is a basic example of an application that stores a set of case class instances in a database, retrieves them back, and prints out afterwards:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Basic</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {

  <span class="pl-c"><span class="pl-c">//</span> Define a simple case class to represent our data model</span>
  <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Person</span>(<span class="pl-v">name</span>: <span class="pl-k">String</span>, <span class="pl-v">age</span>: <span class="pl-k">Int</span>)

  <span class="pl-c"><span class="pl-c">//</span> Define a type mapping used to transform class names into the doc kind</span>
  <span class="pl-k">val</span> <span class="pl-en">typeMapping</span> <span class="pl-k">=</span> <span class="pl-en">TypeMapping</span>(<span class="pl-c1">classOf</span>[<span class="pl-en">Person</span>] <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Person<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> Define some sample data</span>
  <span class="pl-k">val</span> <span class="pl-en">alice</span> <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Alice<span class="pl-pds">"</span></span>, <span class="pl-c1">25</span>)
  <span class="pl-k">val</span> <span class="pl-en">bob</span>   <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Bob<span class="pl-pds">"</span></span>, <span class="pl-c1">30</span>)
  <span class="pl-k">val</span> <span class="pl-en">carl</span>  <span class="pl-k">=</span> <span class="pl-en">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Carl<span class="pl-pds">"</span></span>, <span class="pl-c1">20</span>)

  <span class="pl-c"><span class="pl-c">//</span> Create a CouchDB client instance</span>
  <span class="pl-k">val</span> <span class="pl-en">couch</span>  <span class="pl-k">=</span> <span class="pl-en">CouchDb</span>(<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>, <span class="pl-c1">5984</span>)
  <span class="pl-c"><span class="pl-c">//</span> Define a database name</span>
  <span class="pl-k">val</span> <span class="pl-en">dbName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>couchdb-scala-basic-example<span class="pl-pds">"</span></span>
  <span class="pl-c"><span class="pl-c">//</span> Get an instance of the DB API by name and type mapping</span>
  <span class="pl-k">val</span> <span class="pl-en">db</span>     <span class="pl-k">=</span> couch.db(dbName, typeMapping)

  <span class="pl-k">val</span> <span class="pl-en">actions</span> <span class="pl-k">=</span> <span class="pl-k">for</span> {
  <span class="pl-c"><span class="pl-c">//</span> Delete the database or ignore the error if it doesn't exist</span>
    _ <span class="pl-k">&lt;</span><span class="pl-k">-</span> couch.dbs.delete(dbName).ignoreError
    <span class="pl-c"><span class="pl-c">//</span> Create a new database</span>
    _ <span class="pl-k">&lt;</span><span class="pl-k">-</span> couch.dbs.create(dbName)
    <span class="pl-c"><span class="pl-c">//</span> Insert documents into the database</span>
    _ <span class="pl-k">&lt;</span><span class="pl-k">-</span> db.docs.createMany(<span class="pl-en">Seq</span>(alice, bob, carl))
    <span class="pl-c"><span class="pl-c">//</span> Retrieve all documents from the database and unserialize to Person</span>
    docs <span class="pl-k">&lt;</span><span class="pl-k">-</span> db.docs.getMany.includeDocs[<span class="pl-en">Person</span>].build.query
  } <span class="pl-k">yield</span> docs.getDocsData

  <span class="pl-c"><span class="pl-c">//</span> Execute the actions and process the result</span>
  actions.attemptRun <span class="pl-k">match</span> {
    <span class="pl-c"><span class="pl-c">//</span> In case of an error (left side of Either), print it</span>
    <span class="pl-k">case</span> <span class="pl-k">-</span>\<span class="pl-k">/</span>(e) <span class="pl-k">=&gt;</span> println(e)
    <span class="pl-c"><span class="pl-c">//</span> In case of a success (right side of Either), print each object</span>
    <span class="pl-k">case</span> \<span class="pl-k">/-</span>(a) <span class="pl-k">=&gt;</span> a.map(println(_))
  }

}</pre>
  </div> 
  <p>You can run this example from the project directory using <code>sbt</code>:</p> 
  <div class="highlight highlight-source-shell">
   <pre>sbt <span class="pl-s"><span class="pl-pds">"</span>run-main com.ibm.couchdb.examples.Basic<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-mailing-list" class="anchor" href="https://github.com/beloglazov/couchdb-scala#mailing-list" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Mailing list</h2> 
  <p>Please feel free to join our mailing list, we welcome all questions and suggestions: <a href="https://groups.google.com/forum/#!forum/couchdb-scala" target="_blank">https://groups.google.com/forum/#!forum/couchdb-scala</a></p> 
  <h2><a id="user-content-contributing" class="anchor" href="https://github.com/beloglazov/couchdb-scala#contributing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributing</h2> 
  <p>We welcome contributions, but request you follow these guidelines. Please raise any bug reports on the project's <a href="https://github.com/beloglazov/couchdb-scala/issues" target="_blank">issue tracker</a>.</p> 
  <p>In order for us to accept pull-requests, the contributor must first complete a Contributor License Agreement (CLA). This clarifies the intellectual property license granted with any contribution. It is for your protection as a Contributor as well as the protection of IBM and its customers; it does not change your rights to use your own Contributions for any other purpose.</p> 
  <p>You can download the CLAs here:</p> 
  <ul> 
   <li><a href="https://github.com/beloglazov/couchdb-scala/blob/master/cla/cla-individual.pdf" target="_blank">individual</a></li> 
   <li><a href="https://github.com/beloglazov/couchdb-scala/blob/master/cla/cla-corporate.pdf" target="_blank">corporate</a></li> 
  </ul> 
  <p>If you are an IBMer, please contact us directly as the contribution process is slightly different.</p> 
  <h2><a id="user-content-contributors" class="anchor" href="https://github.com/beloglazov/couchdb-scala#contributors" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributors</h2> 
  <ul> 
   <li><a href="http://beloglazov.info/" target="_blank">Anton Beloglazov</a> (<a href="https://github.com/beloglazov" target="_blank">@beloglazov</a>)</li> 
   <li>Ermyas Abebe (<a href="https://github.com/ermyas" target="_blank">@ermyas</a>)</li> 
  </ul> 
  <h2><a id="user-content-copyright-and-license" class="anchor" href="https://github.com/beloglazov/couchdb-scala#copyright-and-license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Copyright and license</h2> 
  <p>© Copyright 2015 IBM Corporation, Google Inc. Distributed under the <a href="https://github.com/beloglazov/couchdb-scala/blob/master/LICENSE" target="_blank">Apache 2.0 license</a>.</p> 
 </article>
</div>